{% extends 'base.html.twig' %}

{% block title %}{{article.titre}}{% endblock %}

{% block body %}

	<article>

		<h2 class="text-primary"> {{article.titre}} </h2>
		<div class="metadata"> Publié le {{article.CreatedAt| date ('d/m/y')}} à {{article.createdAt | date('H:i')}}
		</div>
		<div class="Content">
			<img src="{{article.image}}" alt="">

			<p>{{article.contenu}} </p>

			
		</div>

        {% if is_granted('ROLE_ADMIN') %}

            <a href="{{path('modifArticle' , {id : article.id})}}" class="btn btn-primary">Modifier l'article</a>
            <a href="{{path('suppression_show_article' , {id : article.id})}}" id="testSuppression" class="btn btn-primary">Supprimer l'article</a>

        {% else %}

            {% if is_granted('ROLE_USER') %}
                {% if app.user.getId() == article.utilisateur.getId() %}

                    <a href="{{path('modifArticle' , {id : article.id})}}" class="btn btn-primary">Modifier l'article</a>
                    <a href="{{path('suppression_show_article' , {id : article.id})}}" id="testSuppression" class="btn btn-primary">Supprimer l'article</a>

                {% endif %}

            {% endif %}

        {% endif %}

        <h3 class="text-primary"> Événements </h3>

        {% for evenement in article.evenements %}

            <h4 class="text-primary">{{evenement.nom}} </h4>
            <h5 class="text-primary">{{evenement.domaine}} </h5>

             <img src="{{evenement.image}}" alt="">   

            <p>{{evenement.description}}</p>

            <div class="Content">
                <h4 class="text-primary"> Dates </h4>
                
                {% for periode in evenement.periode %}
                    <p>Date de début : {{periode.debut | date('d/m/y H:i')}} </p>
                    <p>Date de fin : {{periode.fin | date('d/m/y H:i')}} </p>

                {% endfor %}
                
                <h4 class="text-primary"> Lieu </h4>

                    <p> Ville : {{evenement.lieu.ville}} </p>
                    <p> Adresse : {{evenement.lieu.adresse}} </p>
                    <p> Code postale : {{evenement.lieu.codePostal}} </p>
                    <p> Nom : {{evenement.lieu.nom}} </p>

                {% for organisateur in evenement.organisateurs %}

                    <h4 class="text-primary"> Organisateur </h4>

                    <p> Nom : {{organisateur.nom}} </p>
                    <p> Site web : {{organisateur.siteWeb}} </p>
                    {#<p> mail : {{organisateur.mail}} </p>#}
                    <img src="{{organisateur.image}}" alt="">
                    <a href="{{path('contactOrganisateurEvenement' , {idOrganisateur : organisateur.id , idEvenement : evenement.id })}}" class="btn btn-primary">Contacter</a>
                    
                    <br><br>

                    {% set listeContact = 0 %}

                    {% for i in organisateur.listeContact %}

                        {% if i.evenement == evenement %}

                            {% set listeContact = i %}

                        {% endif %}

                    {% endfor %}
                    

                    {% for contact in listeContact.contact %}
                        <h5 class="text-primary"> Contacts </h5>

                        <p> Nom : {{contact.nom}} </p>
                        <p> Prenom : {{contact.prenom}} </p>
                        {#<p> Mail : {{contact.mail}} </p>#}
                        <p> teléphone : {{contact.telephone}}</p>
                        <a href="{{path('contactEvenement' , {idContact : contact.id , idEvenement : evenement.id})}}" class="btn btn-primary">Contacter</a>


                    {% endfor %} 

                {% endfor %}
                
            </div>    
        {% endfor %}

        <br>
        <br>
		<a href="{{path('accueil')}}" class="btn btn-primary">accueil</a>


	</article>

    <script>

        $('#testSuppression').on('click',function(e){
            return confirm("Etes vous sûr de vouloir supprimer ?");
        });

    </script>

{% endblock %}